{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Patch map (keys -> RFC6902 operation lists)",
    "type": "object",

    "properties": {
        "$schema": { "type": "string", "format": "uri-reference" }
    },

    "additionalProperties": {
        "type": "array",
        "items": { "$ref": "#/definitions/operation" }
    },

    "definitions": {
        "jsonPointer": {
            "type": "string",
            "pattern": "^(/([^/~]|~0|~1)*)*$"
        },
        "operation": {
            "type": "object",
            "required": ["op", "path"],
            "properties": {
                "op": {
                    "type": "string",
                    "enum": ["add", "remove", "replace", "move", "copy", "test"]
                },
                "path": { "$ref": "#/definitions/jsonPointer" },
                "from": { "$ref": "#/definitions/jsonPointer" },
                "value": {}
            },
            "oneOf": [
                { "properties": { "op": { "const": "add" } }, "required": ["value"] },
                { "properties": { "op": { "const": "remove" } } },
                { "properties": { "op": { "const": "replace" } }, "required": ["value"] },
                { "properties": { "op": { "const": "move" } }, "required": ["from"] },
                { "properties": { "op": { "const": "copy" } }, "required": ["from"] },
                { "properties": { "op": { "const": "test" } }, "required": ["value"] }
            ],
            "additionalProperties": false
        }
    }
}
